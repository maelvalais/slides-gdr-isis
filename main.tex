\input{config.tex} % Les usepackage sont dans config.tex
\input{macros.tex} % 



\title{Optimisation de dictionnaires structurés en arbres de convolutions pour la représentation parcimonieuse d'images}
\subtitle{Stage encadré par\\François Malgouyres (IMT), Jean-Yves Tourneret (IRIT-ENSEEIHT) et Herwig Wendt (CNRS-ENSEEIHT)}



\date{Soutenance de stage du 8 septembre 2016}
\author{Maël Valais}
\institute{Université Toulouse III - Paul Sabatier}

\begin{document}

\maketitle


\section{Introduction}
\subsection{La représentation parcimonieuse}


\begin{frame}{La représentation parcimonieuse}
\begin{itemize}
\item La représentation parcimonieuse permet de débruiter, décrire, compresser, classifier
\item Exemple de débruitage en utilisant K-SVD sur l'image bruitée :
	\begin{columns}
	\begin{column}{0.30\textwidth} \begin{figure}\centering
		\includegraphics[width=\textwidth]{figures/exple-denoise/noisy.jpg}
	\end{figure}\end{column}
	\begin{column}{0.1\textwidth} \centering
		$\rightarrow$
		Learn $\D$
	\end{column}
	\begin{column}{0.30\textwidth} \begin{figure}\centering
		\includegraphics[width=\textwidth]{figures/exple-denoise/dict_ksvd.jpg}
	\end{figure} \end{column}
	\begin{column}{0.12\textwidth} \centering
		$\rightarrow$\\
		Denoise \\
		using\\
		$\D$
	\end{column}
	\begin{column}{0.30\textwidth} \begin{figure}\centering
		\includegraphics[width=\textwidth]{figures/exple-denoise/denoised_ksvd.jpg}
	\end{figure} \end{column}
	\end{columns}
\end{itemize}
\end{frame}


\begin{frame}{Les dictionnaires}
\begin{itemize}
\item Un dictionnaire peut permettre de représenter parcimonieusement
\item Deux grands types de dictionnaires : générique et appris
	\begin{table}[] \centering
	\begin{tabular}{@{}lcc@{}} \toprule
	 & Rapide & Adaptatif \\ \midrule
	DCT (générique) & \Geq{\cmark} & \Req{\xmark}\\
	K-SVD (appris) & \Req{\xmark} & \Geq{\cmark} \\ \bottomrule
	\end{tabular}
	\end{table}
\end{itemize}
\end{frame}



\begin{frame}{Problème du coût de Dx}
Problème d'apprentissage de dictionnaire \eqref{eq_dl} pour apprendre un dictionnaire parcimonieux :
\begin{align} 
\underset{\D,\x}{\min}~ & \| \x \|_1 + \lambda \| \Beq{\D\x}-\y \|^2_2 \tag{$DL$}\label{eq_dl} \\
\text{s.t.}~ & \| \d_k \| \le \gamma & \forall k = 1,\dots,K\label{eq_dl_finite_norm} \notag
\end{align}
\begin{description}
	\item[Problème] Coût élevé de $\D\x$ : $O(N^2)$
	\item[Solution] Réduire la taille des images en entrée (patches dans KSVD)
	\item[Défaut] Les atomes ne peuvent pas représenter de grandes formes
\end{description}
\end{frame}


\begin{frame}{Motivations générales}
	\begin{itemize}
		\item développer une \alert{transformée rapide} adaptée aux grands atomes
		\item effectuer l'apprentissage \alert{directement sur l'image} au lieu des patches
	\end{itemize}
\end{frame}







\section{Existant}






\begin{frame}{Le modèle d'arbres de convolutions}
\begin{figure}
	\includegraphics[width=\textwidth]{figures/tree.pdf}
\end{figure}
Ainsi, le produit $\D\x$ est réduit à
\begin{equation} 
\D \x = \Beq{\sum_{l \in ~\text{Feuilles}}} \x^{\Beq{l}} * \underbrace{\h^{\Beq{l}}* \dots* \h^{r}}_{\textrm{de la racine à la feuille}}
\end{equation}
soit une complexité en $O(N)$.
\end{frame}
 

\begin{frame}{Problème associé}
On appelle \eqref{eq_ftl} (\emph{Fast Transform Learning}) l'adaptation de \eqref{eq_dl} à ce modèle :
\begin{equation*} {\small
\underset{\substack{(\h^\text{e})_{e \in \E}}}\min
	\norm{\Beq{\sum_{l \in Feuilles}} \x^{\Beq{l}} * \h^{*\Beq{l}} -\y}{2}^2 \tag{${FTL}$} \label{eq_ftl}
    }
\end{equation*}
L'algorithme \emph{PALMTREE} donne une solution à ce problème :
\begin{itemize}
	\item algorithme proximal itérant successivement sur les blocs de variables $\h^e$
	\item \cite{chabiron_optimization_2016} a montré que le point  critique atteint n'est pas trop éloigné du minimum global
\end{itemize}
\end{frame}


\begin{frame}{Exemple de solution de PALMTREE}
\textbf{Entrées :} \begin{itemize}
	\item image $\y$,
	\item code $\x$ (un code $\x^l \in \R^N$ par feuille)
	\item supports $\s^e$, arbre $\T$
\end{itemize}
\begin{columns}
\begin{column}{1\textwidth} \begin{figure}\centering
	\includegraphics[width=\textwidth]{figures/tree-learn-setup/inputs.pdf}
\end{figure}\end{column}
\end{columns}
\end{frame}


\begin{frame}{Exemple de solution de PALMTREE}
\textbf{Sortie :} les noyaux $\h$
\begin{columns}
\begin{column}{1\textwidth} \begin{figure}\centering
	\includegraphics[width=\textwidth]{figures/tree-learn-setup/outputs.pdf}
\end{figure}\end{column}
\end{columns}
\end{frame}


\begin{frame}{Objectifs du stage}
\begin{alertblock}{Inconvénients de PALMTREE}
\begin{itemize}
\item Supports fixes = perte d'adaptabilité
\item Arbre fixe
\end{itemize}
\end{alertblock}
\begin{columns} \centering
\begin{column}{0.20\textwidth} \begin{figure}\centering
	\includegraphics[width=0.9\textwidth]{figures/manual-better-support/target.pdf}
\end{figure}\end{column}
\begin{column}{0.20\textwidth} \begin{figure}\centering
	\includegraphics[width=0.5\textwidth]{figures/manual-better-support/support.pdf}
\end{figure}\end{column}
\begin{column}{0.2\textwidth}
\begin{center}
	\tikz\path[draw=black,->,thick]<1-> (0,0) -- (3,0);
	Support plus adapté ?
\end{center}
\end{column}
\begin{column}{0.20\textwidth} \begin{figure}\centering
	\includegraphics[width=0.9\textwidth]{figures/manual-better-support/support-better.pdf}
\end{figure}\end{column}
\end{columns}
\begin{exampleblock}{Objectifs du stage}
Apprendre les supports à partir de l'image $\y$
\end{exampleblock}
\end{frame}




\section{Travail réalisé}

\begin{frame}{L'idée}
\begin{block}{Algorithme OMP}
	\begin{enumerate}
		\item \textbf{Chercher} meilleur élément à ajouter au support
		\item Ajouter l'élément
		\item \textbf{Projeter} orthogonalement pour prendre en compte l'ajout
		\item Recommencer jusqu'à ce que le support soit assez grand
	\end{enumerate}
\end{block}
\begin{itemize}
\item \textbf{Pour chercher :} direction de plus forte descente (gradient)
\item \textbf{Pour projeter :} utiliser PALMTREE
\end{itemize}
\begin{exampleblock}{Questionnements}
\begin{itemize}
	\item Gradient convenable pour ajouter le meilleur élément possible ?
	\item Cet algorithme fonctionne t-il dans le cadre d'un arbre ?
\end{itemize}
\end{exampleblock}
\end{frame}


\begin{frame}{Ajouter un élément au support avec le gradient?}
\end{frame}
\includegraphics[width=0.5\textwidth]{figures/check-gradient/tree_classic.pdf}
\begin{frame}{OMP-PALMTREE sur une branche}
\end{frame}


\begin{frame}{OMP-PALMTREE sur un arbre}
Soucis
\begin{itemize}
	\item les éléments de chaque supports sont très éloignés les uns des autres
	\item la taille du support est déséquilibrée à travers l'arbre
\end{itemize}
\end{frame}


\begin{frame}{Régularisation}
\end{frame}


\begin{frame}{En quelques mots...}
\begin{itemize}
\item PALMTREE (existant) se base sur des arbres de convolutions
\item Passer des supports fixes (PALMTREE) à des supports appris (OMP-PALMTREE)
\item ...
\end{itemize}
\vfill
\hfill Merci de votre attention
\end{frame}

\appendix

\begin{frame}[allowframebreaks,noframenumbering]
\frametitle{Bibliographie}
%\nocite{}
\printbibliography[heading=none]
\end{frame}


\end{document}